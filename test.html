<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Cielo/Mar ‚Äì Generador</title>
  <style>
    :root{
      --pad: 16px;
      --radius: 18px;
      --card-bg: rgba(255,255,255,.18);
      --card-border: rgba(255,255,255,.28);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.74);
    }

    *{ box-sizing: border-box; }
    html, body { height: 100%; }
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color: var(--text);
      overflow-x:hidden;
      background:#081423; /* fallback */
    }

    /* Fondo canvas a pantalla completa */
    canvas#bg{
      position: fixed;
      inset: 0;
      width: 100vw;
      height: 100vh;
      z-index: -2;
      display:block;
    }

    /* Vignette suave por encima del fondo */
    .vignette{
      position: fixed;
      inset: 0;
      z-index: -1;
      pointer-events:none;
      background:
        radial-gradient(1200px 700px at 50% 30%, rgba(0,0,0,.08), rgba(0,0,0,.45)),
        linear-gradient(to bottom, rgba(0,0,0,.12), rgba(0,0,0,.28));
    }

    header{
      padding: calc(var(--pad) + 6px) var(--pad) var(--pad);
      display:flex;
      gap: 12px;
      align-items:center;
      justify-content: space-between;
      flex-wrap: wrap;
    }

    .brand{
      display:flex;
      flex-direction:column;
      line-height:1.1;
    }
    .brand b{
      font-size: 15px;
      letter-spacing: .2px;
    }
    .brand span{
      font-size: 12px;
      color: var(--muted);
    }

    button{
      -webkit-tap-highlight-color: transparent;
      appearance:none;
      border: 1px solid rgba(255,255,255,.25);
      background: rgba(0,0,0,.18);
      color: rgba(255,255,255,.92);
      padding: 10px 12px;
      border-radius: 999px;
      font-weight: 600;
      font-size: 13px;
      letter-spacing: .2px;
      backdrop-filter: blur(10px) saturate(160%);
      -webkit-backdrop-filter: blur(10px) saturate(160%);
      cursor:pointer;
    }
    button:active{
      transform: translateY(1px);
    }

    .controls{
      display:flex;
      align-items:center;
      gap: 8px;
    }

    .segmented{
      display:flex;
      align-items:center;
      padding: 3px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.22);
      background: rgba(0,0,0,.16);
      backdrop-filter: blur(10px) saturate(160%);
      -webkit-backdrop-filter: blur(10px) saturate(160%);
    }
    .segmented .seg-btn{
      border: 0;
      background: transparent;
      padding: 7px 12px;
      font-size: 12px;
      letter-spacing: .2px;
      border-radius: 999px;
      color: rgba(255,255,255,.84);
    }
    .segmented .seg-btn.is-active{
      border: 1px solid rgba(255,255,255,.28);
      background: rgba(255,255,255,.16);
      color: rgba(255,255,255,.95);
    }

    main{
      padding: 0 var(--pad) calc(var(--pad) * 2);
      display:flex;
      justify-content:center;
    }

    .card{
      width: min(560px, 100%);
      border-radius: var(--radius);
      padding: 18px 16px;
      background: var(--card-bg);
      border: 1px solid var(--card-border);
      box-shadow:
        0 18px 60px rgba(0,0,0,.35),
        inset 0 1px 0 rgba(255,255,255,.18);

      /* El efecto clave ‚Äúa trav√©s del bloque‚Äù */
      backdrop-filter: blur(16px) saturate(170%) contrast(112%) hue-rotate(8deg);
      -webkit-backdrop-filter: blur(16px) saturate(170%) contrast(112%) hue-rotate(8deg);

      position: relative;
      overflow: hidden;
    }

    /* Grain / textura sutil dentro del bloque */
    .card::before{
      content:"";
      position:absolute;
      inset:-40px;
      pointer-events:none;
      opacity:.18;
      background:
        repeating-linear-gradient(
          0deg,
          rgba(255,255,255,.10) 0px,
          rgba(255,255,255,.10) 1px,
          rgba(0,0,0,0) 2px,
          rgba(0,0,0,0) 5px
        ),
        repeating-linear-gradient(
          90deg,
          rgba(0,0,0,.08) 0px,
          rgba(0,0,0,.08) 1px,
          rgba(0,0,0,0) 2px,
          rgba(0,0,0,0) 6px
        );
      mix-blend-mode: overlay;
      filter: blur(.2px);
    }

    h1{
      margin: 0 0 8px;
      font-size: 18px;
      letter-spacing: .2px;
    }
    p{
      margin: 0 0 10px;
      color: var(--muted);
      font-size: 14px;
      line-height: 1.5;
    }
    .hint{
      margin-top: 10px;
      font-size: 12px;
      opacity: .85;
    }

    /* Un ‚Äúpill‚Äù informativo dentro de la card */
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 8px 10px;
      border-radius: 999px;
      background: rgba(0,0,0,.16);
      border: 1px solid rgba(255,255,255,.18);
      color: rgba(255,255,255,.86);
      font-size: 12px;
      margin-top: 6px;
    }

    @supports not ((backdrop-filter: blur(1px)) or (-webkit-backdrop-filter: blur(1px))) {
      .card{
        /* fallback cuando no hay backdrop-filter */
        background: rgba(0,0,0,.32);
      }
    }
  </style>
</head>
<body>
  <canvas id="bg"></canvas>
  <div class="vignette" aria-hidden="true"></div>

  <header>
    <div class="brand">
      <b>Cielo / Mar</b>
      <span>Generador procedural (tap o bot√≥n)</span>
    </div>
    <div class="controls">
      <div class="segmented" role="group" aria-label="Modo">
        <button class="seg-btn is-active" data-mode="sky" aria-pressed="true">Cielo</button>
        <button class="seg-btn" data-mode="sea" aria-pressed="false">Mar</button>
      </div>
      <button id="btn">Randomizar</button>
    </div>
  </header>

  <main>
    <section class="card">
      <h1>Bloque semitransparente</h1>
      <p>
        Esto es un texto de prueba. Lo que ves ‚Äúa trav√©s‚Äù del bloque es el fondo,
        pero con un efecto a√±adido: <b>blur + saturaci√≥n + contraste + hue</b>, adem√°s de una
        textura suave encima.
      </p>
      <p>
        Ideal para una UI tipo ‚Äúglass‚Äù sobre un fondo org√°nico (cielo/mar).
      </p>
      <div class="pill" id="mode-pill">Modo: Cielo</div>
      <div class="pill">Tip: toca el fondo para randomizar üëÜ</div>
      <div class="hint">Mobile-first ‚Ä¢ Canvas a pantalla completa ‚Ä¢ Sin librer√≠as</div>
    </section>
  </main>

  <script>
    const canvas = document.getElementById("bg");
    const ctx = canvas.getContext("2d", { alpha: false });

    const palettes = [
      {
        name: "Amanecer c√°lido",
        sky1: "#2b1b3a", sky2: "#ff6b6b", sky3: "#ffd166",
        sea1: "#0b2a4a", sea2: "#116e8a", foam: "rgba(255,255,255,.35)"
      },
      {
        name: "Azul limpio",
        sky1: "#061a2d", sky2: "#1d7dd8", sky3: "#b9f5ff",
        sea1: "#061a2d", sea2: "#0aa6c2", foam: "rgba(255,255,255,.28)"
      },
      {
        name: "Noche violeta",
        sky1: "#060616", sky2: "#2d1b7a", sky3: "#8be9ff",
        sea1: "#040614", sea2: "#1b3a8a", foam: "rgba(255,255,255,.22)"
      },
      {
        name: "Verde raro",
        sky1: "#071b19", sky2: "#0e6b6f", sky3: "#b7ffb1",
        sea1: "#041214", sea2: "#0a7c8c", foam: "rgba(255,255,255,.24)"
      }
    ];

    // RNG determinista simple
    function mulberry32(seed) {
      return function() {
        let t = seed += 0x6D2B79F5;
        t = Math.imul(t ^ (t >>> 15), t | 1);
        t ^= t + Math.imul(t ^ (t >>> 7), t | 61);
        return ((t ^ (t >>> 14)) >>> 0) / 4294967296;
      };
    }

    function resize() {
      const dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
      canvas.width = Math.floor(window.innerWidth * dpr);
      canvas.height = Math.floor(window.innerHeight * dpr);
      canvas.style.width = window.innerWidth + "px";
      canvas.style.height = window.innerHeight + "px";
      ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
      draw(currentSeed);
    }

    let currentSeed = (Date.now() & 0xffffffff) >>> 0;

    function drawSky(rand, pal, w, h) {
      // Gradiente principal del cielo a pantalla completa
      const skyGrad = ctx.createLinearGradient(0, 0, 0, h);
      skyGrad.addColorStop(0, pal.sky1);
      skyGrad.addColorStop(0.58, pal.sky2);
      skyGrad.addColorStop(1, pal.sky3);
      ctx.fillStyle = skyGrad;
      ctx.fillRect(0, 0, w, h);

      // ‚ÄúSol‚Äù suave / glow
      const sunX = w * (0.18 + rand() * 0.64);
      const sunY = h * (0.18 + rand() * 0.24);
      const sunR = Math.min(w, h) * (0.12 + rand() * 0.14);

      const rg = ctx.createRadialGradient(sunX, sunY, 0, sunX, sunY, sunR);
      rg.addColorStop(0, "rgba(255,255,255,.20)");
      rg.addColorStop(0.35, "rgba(255,255,255,.10)");
      rg.addColorStop(1, "rgba(255,255,255,0)");
      ctx.fillStyle = rg;
      ctx.fillRect(0, 0, w, h);

      // Nubes tipo ‚Äúneblina‚Äù (streaks)
      ctx.globalAlpha = 0.18;
      const cloudCount = 12;
      for (let i = 0; i < cloudCount; i++){
        const y = rand() * h * 0.78;
        const cloudH = 18 + rand() * 42;
        const a = 0.10 + rand() * 0.10;
        const g = ctx.createLinearGradient(0, y, w, y);
        g.addColorStop(0, `rgba(255,255,255,0)`);
        g.addColorStop(0.25, `rgba(255,255,255,${a})`);
        g.addColorStop(0.75, `rgba(255,255,255,${a * 0.7})`);
        g.addColorStop(1, `rgba(255,255,255,0)`);
        ctx.fillStyle = g;
        ctx.fillRect(0, y, w, cloudH);
      }
      ctx.globalAlpha = 1;

      // Haze suave en la parte baja del cielo
      const haze = ctx.createLinearGradient(0, h * 0.6, 0, h);
      haze.addColorStop(0, "rgba(255,255,255,0)");
      haze.addColorStop(1, "rgba(255,255,255,.08)");
      ctx.fillStyle = haze;
      ctx.fillRect(0, h * 0.6, w, h * 0.4);
    }

    function drawSea(rand, pal, w, h, seed) {
      // Gradiente del mar a pantalla completa
      const seaGrad = ctx.createLinearGradient(0, 0, 0, h);
      seaGrad.addColorStop(0, pal.sea2);
      seaGrad.addColorStop(1, pal.sea1);
      ctx.fillStyle = seaGrad;
      ctx.fillRect(0, 0, w, h);

      // Reflejo vertical suave
      const glareW = w * (0.08 + rand() * 0.10);
      const glareX = w * (0.18 + rand() * 0.64) - glareW / 2;
      const glareGrad = ctx.createLinearGradient(glareX, 0, glareX, h);
      glareGrad.addColorStop(0, "rgba(255,255,255,.16)");
      glareGrad.addColorStop(0.55, "rgba(255,255,255,.06)");
      glareGrad.addColorStop(1, "rgba(255,255,255,0)");
      ctx.fillStyle = glareGrad;
      ctx.fillRect(glareX, 0, glareW, h);

      // Ondas (l√≠neas seno) + espuma suave en tercio superior
      const waveCount = 130;
      const ampBase = 6 + rand() * 12;
      const freqBase = 0.010 + rand() * 0.018;
      const speedish = 0.8 + rand() * 1.5;
      const foamBand = Math.floor(h * (0.20 + rand() * 0.10));

      ctx.lineWidth = 1;
      for (let i = 0; i < waveCount; i++) {
        const t = i / (waveCount - 1);
        const y = t * h;
        const depth = t * t;
        const amp = ampBase * (0.35 + depth * 1.35);
        const freq = freqBase * (0.7 + depth * 1.15);
        const phase = (seed * 0.0002 * speedish) + i * 0.13;

        const alpha = 0.05 + (1 - t) * 0.06;
        ctx.strokeStyle = `rgba(255,255,255,${alpha})`;

        ctx.beginPath();
        for (let x = 0; x <= w; x += 6) {
          const dy = Math.sin(x * freq + phase) * amp;
          const bump = Math.sin(x * (freq * 0.55) - phase * 1.7) * (amp * 0.35);
          const yy = y + dy + bump;
          if (x === 0) ctx.moveTo(x, yy);
          else ctx.lineTo(x, yy);
        }
        ctx.stroke();

        if (y < foamBand && rand() < 0.06) {
          ctx.globalAlpha = 0.55;
          ctx.fillStyle = pal.foam;
          const fx = rand() * w;
          const fw = 30 + rand() * 120;
          const fh = 2 + rand() * 5;
          ctx.fillRect(fx, y + (rand() - 0.5) * 6, fw, fh);
          ctx.globalAlpha = 1;
        }
      }
    }

    function drawGrain(rand, w, h) {
      // Ruido muy fino global
      const grainN = Math.floor((w * h) / 18000);
      ctx.globalAlpha = 0.06;
      ctx.fillStyle = "#ffffff";
      for (let i = 0; i < grainN; i++){
        const x = rand() * w;
        const y = rand() * h;
        ctx.fillRect(x, y, 1, 1);
      }
      ctx.globalAlpha = 1;
    }

    function draw(seed) {
      const rand = mulberry32(seed);

      const w = window.innerWidth;
      const h = window.innerHeight;
      const pal = palettes[Math.floor(rand() * palettes.length)];

      if (currentMode === "sky") drawSky(rand, pal, w, h);
      else drawSea(rand, pal, w, h, seed);

      drawGrain(rand, w, h);
    }

    function randomize(){
      currentSeed = ((Math.random() * 0xffffffff) >>> 0);
      draw(currentSeed);
    }

    let currentMode = "sky";

    function setMode(mode) {
      if (mode === currentMode) return;
      currentMode = mode;
      document.querySelectorAll("[data-mode]").forEach((btn) => {
        const isActive = btn.dataset.mode === currentMode;
        btn.classList.toggle("is-active", isActive);
        btn.setAttribute("aria-pressed", isActive ? "true" : "false");
      });
      const pill = document.getElementById("mode-pill");
      if (pill) pill.textContent = currentMode === "sky" ? "Modo: Cielo" : "Modo: Mar";
      draw(currentSeed);
    }

    document.getElementById("btn").addEventListener("click", randomize);
    canvas.addEventListener("click", randomize);
    window.addEventListener("resize", resize);
    document.querySelectorAll("[data-mode]").forEach((btn) => {
      btn.addEventListener("click", () => setMode(btn.dataset.mode));
    });

    resize();
  </script>
</body>
</html>
